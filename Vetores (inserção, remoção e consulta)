#include <stdio.h>

#define MAX_SIZE 50

void imprimirVetor(int vetor[], int tamanho) {
    printf("Vetor: ");
    for (int i = 0; i < tamanho; i++) {
        printf("%d ", vetor[i]);
    }
    printf("\n");
}

int buscaBinaria(int vetor[], int tamanho, int valor) {
    int esquerda = 0, direita = tamanho - 1;
    while (esquerda <= direita) {
        int meio = (esquerda + direita) / 2;
        if (vetor[meio] == valor) return meio;
        else if (vetor[meio] < valor) esquerda = meio + 1;
        else direita = meio - 1;
    }
    return -1;
}

void removerElemento(int vetor[], int *tamanho, int valor) {
    int pos = buscaBinaria(vetor, *tamanho, valor);
    if (pos == -1) {
        printf("Elemento nao encontrado!\n");
        return;
    }
    for (int i = pos; i < *tamanho - 1; i++) {
        vetor[i] = vetor[i + 1];
    }
    (*tamanho)--;
    printf("Elemento removido com sucesso!\n");
}

void inserirOrdenado(int vetor[], int *tamanho, int valor) {
    if (*tamanho >= MAX_SIZE) {
        printf("Vetor cheio! Nao pode inserir mais elementos.\n");
        return;
    }

    int i = (*tamanho)++;
    while (i > 0 && vetor[i - 1] > valor) {
        vetor[i] = vetor[i - 1];
        i--;
    }
    vetor[i] = valor;
    printf("Elemento inserido com sucesso!\n");
}

int main() {
    int vetor[MAX_SIZE], tamanho = 0, valor, opcao = 0;

    // Solicita o tamanho do vetor ao usuário
    printf("Digite o tamanho do vetor (entre 3 e 50): ");
    scanf("%d", &tamanho);
    while (tamanho < 3 || tamanho > MAX_SIZE) {
        printf("Tamanho inválido. Digite novamente (entre 3 e 50): ");
        scanf("%d", &tamanho);
    }

    // Solicita os elementos do vetor ao usuário e os insere de forma ordenada
    for (int i = 0; i < tamanho; i++) {
        printf("Digite o valor inteiro %d: ", i + 1);
        scanf("%d", &valor);
        inserirOrdenado(vetor, &i, valor);
    }

    // Loop de menu de opções
    while (opcao != 5) {
        printf("\nMenu:\n1. Imprimir todo o vetor\n2. Consultar posicao de um elemento\n3. Remover um elemento\n4. Inserir um valor no vetor\n5. Sair\nEscolha uma opcao: ");
        scanf("%d", &opcao);

        if (opcao == 1) {
            imprimirVetor(vetor, tamanho);
        } else if (opcao == 2) {
            printf("Digite o valor a ser consultado: ");
            scanf("%d", &valor);
            int pos = buscaBinaria(vetor, tamanho, valor);
            if (pos == -1) {
                printf("Elemento nao encontrado!\n");
            } else {
                printf("Elemento encontrado na posicao %d\n", pos);
            }
        } else if (opcao == 3) {
            printf("Digite o valor a ser removido: ");
            scanf("%d", &valor);
            removerElemento(vetor, &tamanho, valor);
        } else if (opcao == 4) {
            printf("Digite o valor a ser inserido: ");
            scanf("%d", &valor);
            inserirOrdenado(vetor, &tamanho, valor);
        } else if (opcao == 5) {
            printf("Saindo...\n");
        } else {
            printf("Opcao invalida!\n");
        }
    }

    return 0;
}
